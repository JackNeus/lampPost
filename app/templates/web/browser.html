{% extends "base.html" %}
{% set no_scroll = True %}

<!--****************************** SCRIPTS **********************************-->

{% block scripts %}
<script src="/static/js/app.js?v=4"></script>
<script src="/static/js/handleUrlParam.js?v=4"></script>
<script src="/static/js/handleFavorites.js?v=4"></script>
<script src="/static/js/calendarView.js?v=4"></script>
<script src="/static/js/browser.js?v=4"></script>
<script>
setBaseUrl("{{ config.BASE_URL }}");
</script>

{% if data %}
<script>
setData(JSON.parse('{{ data | tojson | safe}}'));
$("#global-debug-msg").text("Page initialized with mock data. Search box will return actual data.");
</script>
{% endif %}

{% endblock %}


<!--***************************** MAIN CONTENT ******************************-->
{% block content %}
<div class="container-fluid">
<div class="flex-container-bigrow" id="browserView">
   <div class="flex-container-col slide" id="leftCol">
   		<form class="search-container" onsubmit="return false;">
   			<div class="" id="searchRow">
				<div class="form-group searchBoxCol" id="searchBox">
			    		<input id="search-box" class="form-control"
			    		placeholder="Search for events here!" value=""></input>
				</div>
				<div class="calendar-view-button btn" id="calendarViewBtn" data-toggle="tooltip" title="Calendar View">
					<i class="fas fa-calendar"></i>
				</div>
			</div>
			<div class="flex-row searchButtons align-items-start justify-content-between flex-wrap">
				<div class="filter-button btn" id="filter-btn" title="Filter">
				  <i class="fas fa-filter"></i>
			  	</div>
			  	<div class="ml-auto d-flex flex-nowrap align-items-start sort-box">
			  		{% include "web/sortbox.html" %}
				</div>
			</div>

			<div class="filters flex-col">
				<div class="date-filter datetime d-flex flex-row flex-wrap align-items-center">
					<button class="btn filter-btn" id="timeFilterToggle" type="button">Search by time</button>
					<div class="timeFilter" id="timeFilter" style="display:none;">
						<input type="text" id="startTimepicker" placeholder="Start time" class="timepicker form-control"  name="timepicker">
						<p>to</p>
						<input type="text" id="endTimepicker" class="timepicker form-control" placeholder="End time" name="timepicker">
					</div>
				</div>
				<div class="date-filter datetime d-flex flex-row flex-wrap align-items-center">
					<button class="btn filter-btn" id="dateFilterToggle" type="button">Search from date</button>
					<div class="dateFilter" id="timeFilter" style="display:none;">
						<input type="text" id="datepicker" class="form-control" name="datepicker" placeholder="Start date">
					</div>
				</div>
				<div id="all-events">
					<button type="button" id="all-events-filter-btn" class="btn filter-btn">Show All Events (*)</button>
				</div>
          		{% if current_user.is_authenticated %}
				<div id="favorite-events">
					<button type="button" id="favorite-events-filter-btn" class="btn filter-btn">Favorites Only</button>
				</div>
				{% endif %}

				<div class="form-group" id="tag-filters">
        				<div  class="form-check form-check-inline">
    						<input class="form-check-input" type="checkbox" name="tags" id="tags-0" value="Music">
    						<label class="form-check-label" for="inlineCheckbox0"> <span class="badge badge-primary" id="MusicTag"> Music </span> </label>
	        			</div>
        				<div  class="form-check form-check-inline">
    						<input class="form-check-input" type="checkbox" name="tags" id="tags-1" value="Dance">
    						<label class="form-check-label" for="inlineCheckbox1"> <span class="badge badge-primary" id="DanceTag"> Dance </span> </label>
	        			</div>
        				<div  class="form-check form-check-inline">
    						<input class="form-check-input" type="checkbox" name="tags" id="tags-2" value="Talk">
    						<label class="form-check-label" for="inlineCheckbox2"> <span class="badge badge-primary" id="TalkTag"> Talk </span> </label>
	        			</div>
        				<div  class="form-check form-check-inline">
    						<input class="form-check-input" type="checkbox" name="tags" id="tags-3" value="Theater">
    						<label class="form-check-label" for="inlineCheckbox3"> <span class="badge badge-primary" id="TheaterTag"> Theater </span> </label>
	        			</div>
        				<div  class="form-check form-check-inline">
    						<input class="form-check-input" type="checkbox" name="tags" id="tags-4" value="Street">
    						<label class="form-check-label" for="inlineCheckbox4"> <span class="badge badge-primary" id="StreetTag"> Street </span> </label>
	        			</div>
        				<div  class="form-check form-check-inline">
    						<input class="form-check-input" type="checkbox" name="tags" id="tags-5" value="Orientation">
    						<label class="form-check-label" for="inlineCheckbox5"> <span class="badge badge-primary" id="OrientationTag"> Orientation </span> </label>
	        			</div>
	  				</div>

			 </div>

		</form>

		<!-- Fills in with both search results, and trending events. -->

		<div class="flex-container-scroll searches-wrapper" id="searches-wrapper">
			<div class="calendarBtns" id="calendarBtns">
				<div class="calendarHeader">
          <div class="mr-auto previousWeekBtn btn" id="previousWeekBtn" title="Previous Week">
              <i class="fas fa-arrow-left"></i>
          </div>
          <div class="weekTitle" id="weekTitle"></div>
          <div class="ml-auto nextWeekBtn btn" id="nextWeekBtn" title="Next Week">
              <i class="fas fa-arrow-right"></i>
          </div>
				</div>
			</div>
			<div id="trendingLabel"> Trending Events </div>
			<div id="searches">
            	<div class="searchPost"></div>
        	</div>

			<div class="fa fa-spinner fa-spin hidden centered" id="loading-spinner"></div>
        </div>

  	</div>

 	<div class="flex-container-col slide" id = "rightCol">
 		<div id="welcomeDiv" style="display:none">
 			<div id = "interiorWelcomeDiv">
	 			<h1 id = "welcomeMessage"> Welcome to lampPost! </h1>

				  <div class="row">
				    <div class="col-md-6">
	 					<p class = "welcomeText" > Get started by:
	 					<ul class="welcomeText">
	 						<li> <a class="keyword"> Browsing </a> through trending events on the left! </li>
	 						<li> <a class="keyword"> Searching </a> for events by keyword/date/location. </li>
	 						<li> <a class="keyword"> Exporting </a> your favorites to Google Calendar. </li>
	 						<li> <a class="keyword"> Adding </a> your own event! </li>
	 					</ul>
	 					</p>
	 				</div>
				    <div class="col-md-6 welcome-img">
				      <img class="img-fluid fit" id="welcome" src="../../static/graphics/images/lamppostMeme.png">
				    </div>
				  </div>
	 		</div>
 		</div>
 		{% include "web/eventview.html" %}
	</div>

    {% if formR %}
        <div id="myModal" class="modal fade" role="dialog">
          <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
              <div class="modal-header">
                <h4 class="modal-title" > Report <a id="reportPopupTitle" style="font-weight:bold"> </a>?</h4>
                <button onclick="clearReportForm()" type="button" class="close" data-dismiss="modal">&times;</button>
              </div>

            <form id="reportForm"  method="POST" role="form" enctype="multipart/form-data">
                {{ formR.csrf_token }}
                <!-- Hidden event id, populated by jquery -->
                {{ formR.event_id(class="hidden") }}

              <div class="modal-body">
                <p> We take event maintenance seriously, and appreciate you taking the time to submit a report. Choose the issue below, and optionally also provide a description. </p>


                    <div class="form-group">
                        {{ formR.category.label(style="padding-right:1vw", class="req") }}
                        {% for subfield in formR.category %}
                            <div class="form-check form-check-inline">
                                {{ subfield(class="form-check-input") }}
                                {{ subfield.label(style="font-weight:normal", class="form-check-label") }}
                            </div>
                        {% endfor %}
                    </div>

                    <div class="form-group">
                        {{ formR.description.label() }}
                        {{ formR.description(placeholder="Optionally, include details about why this event should be removed.", class="form-control", rows="4", maxlength="3000") }}
                    </div>


              </div>
              <div class="modal-footer">
                <button type="submit" class="btn btn-primary submitAddButton">Submit!</button>
                <button type="button" class="btn btn-default" data-dismiss="modal" onclick="clearReportForm()">Close</button>
              </div>
            </form>

            </div>

          </div>
        </div>
    {% endif %}
</div>
</div>
{% endblock %}
